# 项目进度总览

> 最后更新：2026-02-28

## 📊 整体进度

- **基础架构**: ✅ 100% 完成
- **数据同步**: ✅ 100% 完成（已完成首阶段分层重构）
- **图片存储**: ✅ 100% 完成
- **文档体系**: ✅ 100% 重构完成（符合四大标准）
- **PC 端开发**: 🔄 70% 进行中（交互重构完成，进入体验打磨阶段）
- **移动端开发**: ✅ 95% 接近完成（交互与优化基本到位）
- **内容填充**: ⏳ 0% 待开始
- **部署上线**: ⏳ 0% 待开始

**总体进度**: 约 80% 完成

---

## ✅ 已完成（Developer A）

### 第一阶段：项目初始化（2026-02-02）

- [x] Next.js 14 项目创建（App Router）
- [x] TypeScript 配置
- [x] Tailwind CSS v4 配置
- [x] ESLint 配置
- [x] Git 仓库初始化并连接 GitHub

### 第二阶段：核心依赖安装（2026-02-02）

- [x] Shadcn/UI 组件库
  - Button, Dialog, ScrollArea, Tooltip
- [x] Framer Motion 动画库
- [x] Zustand 状态管理
- [x] Lucide React 图标库
- [x] 中文字体配置（Noto Serif SC + Noto Sans SC）

### 第三阶段：基础架构搭建（2026-02-02）

- [x] 项目目录结构
  - `src/app/` - Next.js 路由
  - `src/components/` - 组件（ui, shared, desktop, mobile）
  - `src/lib/` - 工具函数和类型
  - `src/data/` - 数据文件
  - `src/scripts/` - 脚本工具
- [x] 核心类型定义（`types.ts`）
  - Story 接口
  - LocationPoint 接口
  - FeishuResponse 接口
- [x] 全局状态管理（`store.ts`）
  - 信封状态
  - 选中地点
  - 当前故事索引
- [x] 响应式检测 Hook（`hooks.ts`）
- [x] 工具函数（`utils.ts`）

### 第四阶段：页面与组件（2026-02-02）

- [x] 全局布局（`layout.tsx`）
  - 字体配置
  - 元数据配置
- [x] 主页（`page.tsx`）
  - 响应式分流逻辑
  - PC/移动端组件加载
- [x] Loading 页面（`loading.tsx`）
- [x] 404 页面（`not-found.tsx`）
- [x] 开场信封动画（`EnvelopeIntro.tsx`）
  - 信封打开动画
  - 状态管理集成
- [x] PC 端占位组件（`DesktopExperience.tsx`）
- [x] 移动端占位组件（`MobileExperience.tsx`）

### 第五阶段：数据准备（2026-02-02）
- [x] 数据结构验证
- [ ] ~~生成 Mock 数据（mock-content.json）~~ (已废弃，改用飞书同步)

### 第六阶段：飞书数据同步（2026-02-03）

**认证与 API 集成**
- [x] 飞书应用创建与配置
- [x] tenant_access_token 获取
- [x] Wiki 节点 API 集成
  - 从 Wiki URL 获取 app_token
  - 脚本：`get-wiki-app-token.ts`
- [x] Bitable 搜索记录 API
  - 支持分页
  - 支持视图过滤
  - 支持条件过滤

**表格初始化**
- [x] 创建表格字段
  - 角色ID、角色名
  - 头像URL、大图URL
  - 故事内容、投稿人、日期
  - 地点ID、地点名称
  - 状态（单选）
- [x] 填充示例数据（3 条记录）
- [x] 脚本：`init-feishu-table.ts`

**数据同步脚本**
- [x] 完整的 ETL 流程 (`sync-feishu.ts`)
- [x] 图片自动上传 OSS
- [x] URL 回写飞书

### 第七阶段：文档重构与标准化（2026-02-21）

- [x] **文档中文化**: 全面重命名并翻译关键文档。
- [x] **标准对齐**:
  - 修改唯一性 (SSOT)
  - 状态纯粹性 (分离 `项目进度.md`)
  - 引用替代复制 (相对路径链接)
  - 无冲突溯源 (明确定义出处)
- [x] **遗漏补全**:
  - 补充 [视觉规范](./design/视觉规范.md) (Assets Checklist)
  - 补充 [环境搭建](./guides/环境搭建.md) (分支管理与目录权限)

### 第八阶段：核心业务开发（2026-02-21）

**移动端 (Developer C)**
- [x] **StoryFeed (瀑布流列表)**: 实现双列瀑布流布局与转场动画。
- [x] **MobileDetailModal (详情页)**: 支持下拉关闭、左右切换与布局动画。
- [x] **StaticMapModal (静态地图)**: 实现地图查看与 Pin 点展示。
- [x] **MobileExperience (主入口)**: 整合子组件并处理 100vh 与滚动穿透问题。

**PC 端 (Developer B)**
- [x] **InteractiveMap (交互地图)**: 实现全屏地图适配，Pin 点定位与交互。
- [x] **StoryCardStack 优化**: 修正幽灵图片问题，优化卡片交互表现。
- [x] **资源更新**: 更换高精度 SVG 地图。

### 第九阶段：稳定性修复（2026-02-25）

- [x] 清零 `eslint` 阻断错误（P0）。
- [x] 收敛脚本/UI 层 `any`，补充关键类型定义。
- [x] 移动端手势状态由 `window` 改为 `useRef`，消除全局污染风险。

### 第十阶段：P1 工程优化（2026-02-25）

- [x] 收敛 `next/image` 的 `unoptimized` 使用。
- [x] 为地图、详情、列表、头像等场景补齐 `sizes`。
- [x] `sync-feishu.ts` 完成单文件分层重构：
  - `feishuClient`
  - `ossService`
  - `dataTransformer`
  - `fileWriter`

### 第十一阶段：PC 端交互重构与体验修复（2026-02-28）

- [x] 地图/故事切换从“图层位移”重构为“上下文档流 + 原生平滑滚动”。
- [x] 故事区增加留白缓冲，文本未展开时地图不侵入故事阅读区。
- [x] 修复快速切换地点时 `Cannot read properties of undefined (reading 'id')` 运行时错误。
- [x] StoryCardStack 在不改变动画语义前提下完成性能优化（`memo/useMemo/useCallback` 与图片预加载）。
- [x] 全局隐藏页面横向溢出，移除底部横向滚动条。

---

## ⏳ 待办事项 (To-Do)

### 基础设施 (Developer A)
- [ ] **EnvelopeIntro 完善**: 补充“关于项目”和“关于我们”的垂直滚动页面。
- [ ] **部署准备**: 配置 Vercel 环境变量与构建命令。
- [ ] **同步脚本测试化**: 为 `dataTransformer` / `getText` / 分页拉取逻辑补充单测。

### PC 端开发 (Developer B)
- [ ] **StoryCardStack 体验打磨**: 在现有动画语义不变前提下继续优化拖拽手感与帧稳定性。
- [ ] **StoryTextArea 体验优化**: 完善文本区阅读节奏与视觉层次。
- [ ] **视觉优化**: 调整地图 Pin 点动画与故事区/地图区衔接细节。

### 移动端开发 (Developer C)
- [ ] **细节验收**: 在真机环境验证 100dvh 兼容性与手势流畅度。
- [ ] **性能验收**: 进行 Lighthouse 对比并评估图片优化收益。

### 内容与运营
- [ ] **数据填充**: 在飞书多维表格中录入真实故事数据。
- [ ] **素材准备**: 收集高质量的校园场景图与角色头像。
